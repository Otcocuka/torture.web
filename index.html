<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torture2 - Unified</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body class="bg-gray-50 min-h-screen text-gray-800 font-sans flex flex-col">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-20">
        <div class="max-w-5xl mx-auto px-4">
            <div class="flex justify-center space-x-1 p-1 bg-gray-100 rounded-lg mt-2 mb-2 w-fit mx-auto">
                <button data-nav="view-habits"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">–ü—Ä–∏–≤—ã—á–∫–∏</button>
                <button data-nav="view-timer"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">–¢–∞–π–º–µ—Ä</button>
                <button data-nav="view-wheel"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">–ö–æ–ª–µ—Å–æ</button>
                <button data-nav="view-todo"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">TODO</button>
                <button data-nav="view-notifications"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">
                    <span>üîî</span> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                </button>
                <button data-nav="view-reader"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">üìñ
                    –ß–∏—Ç–∞–ª–∫–∞</button>
                <button data-nav="view-chat"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">üí¨
                    –ß–∞—Ç</button>
                <!-- NEW: –ö–Ω–æ–ø–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∫ –ê–≤–∞—Ç–∞—Ä—É –∑–Ω–∞–Ω–∏–π -->
                <button data-nav="view-knowledge-avatar"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">üß†
                    –ê–≤–∞—Ç–∞—Ä</button>
                <button data-nav="view-stats"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                <button data-nav="view-settings"
                    class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-standard hover:bg-white hover:shadow-sm text-gray-600">‚öôÔ∏è
                    –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <main class="flex-grow p-4 max-w-5xl mx-auto w-full">

        <!-- 1. HABITS VIEW -->
        <div id="view-habits" class="app-view">
            <div class="max-w-2xl mx-auto space-y-4">
                <!-- Add Habit Form -->
                <div class="bg-white p-4 rounded-lg shadow-sm">
                    <div class="flex gap-2">
                        <input type="text" id="habitInput" placeholder="–ù–æ–≤–∞—è –ø—Ä–∏–≤—ã—á–∫–∞..."
                            class="flex-1 p-2 border rounded-lg focus:ring-2 focus:ring-blue-400 outline-none">
                        <button id="habitSettingsBtn" class="p-2 text-gray-400 hover:text-blue-500" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                        </button>
                        <button id="addHabitBtn"
                            class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                </div>

                <!-- Stats Summary (Achievements Quick View) -->
                <div class="flex justify-between items-center px-2">
                    <h2 class="text-lg font-semibold">–ú–æ–∏ –ü—Ä–∏–≤—ã—á–∫–∏</h2>
                    <button id="viewAchievementsBtn" class="text-sm text-green-600 font-medium hover:underline">üèÜ
                        –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
                </div>

                <!-- Habits List -->
                <div id="habitsList" class="space-y-3"></div>
            </div>
        </div>

        <!-- 2. TIMER VIEW -->
        <div id="view-timer" class="app-view">
            <div class="max-w-2xl mx-auto">
                <!-- Main Timer Display -->
                <div id="timerContainer"
                    class="bg-white p-8 rounded-2xl shadow-lg text-center mb-6 transition-standard theme-work">
                    <h1 class="text-2xl font-bold mb-2 tracking-wide">POMODORO</h1>
                    <div id="timerDisplay" class="text-6xl md:text-8xl font-mono font-bold mb-4">25:00</div>
                    <div id="timerPhaseText" class="text-xl font-semibold uppercase tracking-widest opacity-80">–†–∞–±–æ—Ç–∞
                    </div>

                    <!-- Controls -->
                    <div class="mt-6 flex justify-center gap-3 flex-wrap">
                        <button id="timerStart"
                            class="px-6 py-2 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600 shadow-md">Start</button>
                        <button id="timerPause" disabled
                            class="px-6 py-2 bg-yellow-500 text-white rounded-lg font-bold hover:bg-yellow-600 shadow-md opacity-50">Pause</button>
                        <button id="timerReset"
                            class="px-6 py-2 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600 shadow-md">Reset</button>
                    </div>
                </div>

                <!-- Stats & Settings Row -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Stats -->
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold mb-2 text-gray-500 text-sm">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Å—Å–∏–π</h3>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>–í—Å–µ–≥–æ: <span id="statSessions" class="font-bold">0</span></div>
                            <div>–†–∞–±–æ—Ç–∞: <span id="statWork" class="font-bold">0—Å</span></div>
                            <div>–ü–∞—É–∑–∞: <span id="statPaused" class="font-bold">0—Å</span></div>
                            <div>–û—Ç–¥—ã—Ö: <span id="statBreak" class="font-bold">0—Å</span></div>
                        </div>
                        <button id="resetStatsBtn"
                            class="mt-3 w-full text-xs text-red-500 border border-red-200 py-1 rounded hover:bg-red-50">–°–±—Ä–æ—Å
                            —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</button>
                    </div>

                    <!-- Settings -->
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold mb-2 text-gray-500 text-sm">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–º–∏–Ω)</h3>
                        <div class="grid grid-cols-2 gap-2">
                            <label class="text-xs flex flex-col">Work <input id="settingWork" type="number" value="25"
                                    class="border rounded px-1"></label>
                            <label class="text-xs flex flex-col">Short <input id="settingShort" type="number" value="5"
                                    class="border rounded px-1"></label>
                            <label class="text-xs flex flex-col">Long <input id="settingLong" type="number" value="15"
                                    class="border rounded px-1"></label>
                            <label class="text-xs flex flex-col">Every N <input id="settingCycle" type="number"
                                    value="4" class="border rounded px-1"></label>
                        </div>
                        <button id="saveTimerSettings"
                            class="mt-3 w-full text-xs bg-blue-100 text-blue-700 py-1 rounded hover:bg-blue-200">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. WHEEL VIEW -->
        <div id="view-wheel" class="app-view">
            <div class="max-w-md mx-auto bg-white p-6 rounded-xl shadow-md text-center">
                <h2 class="text-xl font-bold mb-1">–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã</h2>
                <p class="text-sm text-gray-500 mb-4">–í—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</p>

                <div class="relative my-4 canvas-container">
                    <canvas id="wheelCanvas" width="300" height="300"
                        class="border-4 border-gray-100 rounded-full shadow-inner"></canvas>
                    <!-- Arrow -->
                    <div
                        class="absolute top-1/2 right-0 -translate-x-1/2 -translate-y-1/2 rotate-90 w-0 h-0 border-l-[15px] border-l-transparent border-r-[15px] border-r-transparent border-t-[25px] border-t-red-500 filter drop-shadow-md">
                    </div>
                </div>

                <div id="wheelResult"
                    class="text-lg font-bold text-indigo-600 min-h-[2.5rem] mb-4 flex items-center justify-center">
                    –ù–∞–∂–º–∏ "–ö—Ä—É—Ç–∏—Ç—å"
                </div>

                <button id="spinWheelBtn"
                    class="bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 shadow-lg w-full">–ö—Ä—É—Ç–∏—Ç—å</button>

                <div class="mt-4 pt-4 border-t text-xs text-gray-500">
                    –ò—Å—Ç–æ—Ä–∏—è: <span id="wheelHistoryCount">0</span> –ø—Ä–æ–∫—Ä—É—Ç–æ–∫
                </div>
            </div>
        </div>

        <!-- 4. VIEW: –ö–û–ì–ù–ò–¢–ò–í–ù–´–ô –ê–í–ê–¢–ê–† –ó–ù–ê–ù–ò–ô (NEW) -->
        <div id="view-knowledge-avatar" class="app-view hidden">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ UI.renderKnowledgeAvatarView() -->
        </div>

        <!-- 5. STATS VIEW -->
        <div id="view-stats" class="app-view">
            <div class="max-w-4xl mx-auto bg-white p-6 rounded-xl shadow-sm">
                <h2 class="text-2xl font-bold mb-6 text-gray-800 border-b pb-2">–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>

                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-600 mb-3 flex items-center gap-2">
                        <span>‚è≥</span> –û–±—â–µ–µ –≤—Ä–µ–º—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
                    </h3>
                    <div class="bg-gray-100 p-4 rounded-lg text-2xl font-mono font-bold text-gray-800"
                        id="stat-total-uptime">
                        0–º
                    </div>
                </div>

                <!-- Pomodoro Stats -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-blue-600 mb-3 flex items-center gap-2">
                        <span>üçÖ</span> Pomodoro
                    </h3>
                    <div class="grid grid-cols-2 gap-4 bg-blue-50 p-4 rounded-lg">
                        <div>
                            <div class="text-gray-500 text-sm">–°–µ—Å—Å–∏–π –≤—Å–µ–≥–æ</div>
                            <div class="text-2xl font-bold" id="stat-t-sessions">0</div>
                        </div>
                        <div>
                            <div class="text-gray-500 text-sm">–†–∞–±–æ—Ç–∞</div>
                            <div class="text-2xl font-bold text-blue-700" id="stat-t-work">0–º</div>
                        </div>
                        <div>
                            <div class="text-gray-500 text-sm">–û—Ç–¥—ã—Ö</div>
                            <div class="text-2xl font-bold text-green-600" id="stat-t-break">0–º</div>
                        </div>
                        <div>
                            <div class="text-gray-500 text-sm">–ü–∞—É–∑–∞</div>
                            <div class="text-2xl font-bold text-gray-600" id="stat-t-paused">0–º</div>
                        </div>
                    </div>
                </div>

                <!-- Habits Stats with Calendars -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-purple-600 mb-3">‚úÖ –ü—Ä–∏–≤—ã—á–∫–∏</h3>
                    <div class="bg-purple-50 p-4 rounded-lg space-y-4" id="stat-habits-container"></div>
                    <div id="calendar-months"
                        class="flex gap-1 justify-start min-w-[600px] mt-2 text-[10px] text-gray-400 ml-2"></div>
                </div>

                <!-- Wheel Stats -->
                <div>
                    <h3 class="text-lg font-semibold text-indigo-600 mb-3 flex items-center gap-2">
                        <span>üé°</span> –ö–æ–ª–µ—Å–æ
                    </h3>
                    <div class="bg-indigo-50 p-4 rounded-lg space-y-2" id="stat-wheel-container">
                        <!-- –°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JS -->
                        <div class="text-gray-500 text-sm">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 6. TODO VIEW -->
        <div id="view-todo" class="app-view">
            <div class="max-w-6xl mx-auto">
                <!-- Controls -->
                <div class="flex justify-between items-center mb-4 bg-white p-3 rounded-lg shadow-sm">
                    <h2 class="text-lg font-bold">–ö–∞–Ω–±–∞–Ω –î–æ—Å–∫–∞</h2>
                    <div class="flex gap-2">
                        <button id="addKanbanColBtn"
                            class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">–î–æ–±–∞–≤–∏—Ç—å
                            –ö–æ–ª–æ–Ω–∫—É</button>
                    </div>
                </div>

                <!-- Board Area -->
                <div id="kanbanBoard" class="flex gap-4 overflow-x-auto pb-4 min-h-[500px] items-start">
                    <!-- Columns will be rendered here -->
                </div>
            </div>
        </div>

        <!-- 7. notifications VIEW -->
        <div id="view-notifications" class="app-view hidden p-6 max-w-4xl mx-auto">
            <h2 class="text-2xl font-bold mb-4">–ì–∏–±–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
            <div class="bg-yellow-50 border border-yellow-200 text-yellow-800 p-3 rounded text-sm mb-4">
                <strong>‚ÑπÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–æ–∫—É—Å:</strong> –ë—Ä–∞—É–∑–µ—Ä—ã –∑–∞–ø—Ä–µ—â–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –∏–∑
                —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
                –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ "–í–∞–∂–Ω–æ–≥–æ" —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫—Ä–æ–µ—Ç—Å—è <strong>–Ω–æ–≤–æ–µ –æ–∫–Ω–æ/–≤–∫–ª–∞–¥–∫–∞</strong> —Å
                –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.
                –ï—Å–ª–∏ –≤–∫–ª–∞–¥–∫–∞ –±—ã–ª–∞ —Å–≤–µ—Ä–Ω—É—Ç–∞, –≤—ã —É–≤–∏–¥–∏—Ç–µ –º–∏–≥–∞—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —É—Å–ª—ã—à–∏—Ç–µ –∑–≤—É–∫.
            </div>
            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
            <div class="bg-white p-4 rounded-lg shadow-sm mb-6 border border-gray-200">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-end">
                    <div>
                        <label class="block text-xs text-gray-500 mb-1">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                        <input id="notifTitle" type="text" placeholder="–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ" class="w-full border p-2 rounded">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1">–ö–∞–∂–¥—ã–µ (–º–∏–Ω)</label>
                        <input id="notifInterval" type="number" value="20" min="1" class="w-full border p-2 rounded">
                    </div>
                    <div class="flex items-center gap-2 h-10">
                        <label class="flex items-center gap-2 cursor-pointer select-none">
                            <input id="notifImportant" type="checkbox" class="rounded text-red-500 w-5 h-5">
                            <span class="font-medium text-red-600">–í–∞–∂–Ω–æ!</span>
                        </label>
                    </div>
                    <button id="addNotifBtn"
                        class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-medium">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="text-xs text-gray-500 mt-2">
                    * –í–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ø—ã—Ç–∞—é—Ç—Å—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤–∫–ª–∞–¥–∫—É –∏ –∑–∞—Å—Ç–∞–≤—è—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–∏–≥–∞—Ç—å.
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
            <div id="notificationsList" class="space-y-2">
                <!-- JS –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ -->
            </div>
        </div>

        <!-- 8. reader VIEW -->
        <div id="view-reader" class="app-view hidden p-6 max-w-6xl mx-auto w-full h-[calc(100vh-180px)]">
            <div class="flex flex-col gap-4 h-full">

                <!-- 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–º -->
                <div
                    class="bg-white p-4 rounded-lg shadow-sm flex flex-wrap gap-4 items-center justify-between shrink-0">
                    <div class="flex gap-2 items-center">
                        <input type="file" id="readerFileInput" accept=".txt,.md,.html" class="hidden">
                        <button id="readerLoadBtn" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">üìÇ
                            –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
                        <button id="readerClearBtn"
                            class="bg-red-50 text-red-600 px-4 py-2 rounded hover:bg-red-100">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                    <div class="flex gap-3 items-center text-sm">
                        <label>–®—Ä–∏—Ñ—Ç: <select id="readerFontSize" class="border rounded p-1 w-20">
                                <option value="16">16</option>
                                <option value="20" selected>20</option>
                                <option value="24">24</option>
                                <option value="28">28</option>
                            </select></label>
                        <label>–¢–µ–º–∞: <select id="readerTheme" class="border rounded p-1">
                                <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
                                <option value="dark" selected>–¢–µ–º–Ω–∞—è</option>
                            </select></label>
                    </div>
                </div>

                <!-- 2. –û–±–ª–∞—Å—Ç—å —á—Ç–µ–Ω–∏—è -->
                <div id="readerContent"
                    class="flex-1 bg-gray-900 text-gray-100 p-8 rounded-lg overflow-y-auto shadow-inner transition-colors duration-300">
                    <div class="text-gray-500 text-center mt-20">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è —á—Ç–µ–Ω–∏—è</div>
                </div>

                <!-- 3. –ü–∞–Ω–µ–ª—å —Å–µ—Å—Å–∏–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
                <div class="bg-white p-4 rounded-lg shadow-sm shrink-0">
                    <div class="flex justify-between items-center mb-3">
                        <div class="flex gap-2">
                            <button id="readerStartSession"
                                class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å
                                —Å–µ—Å—Å–∏—é</button>
                            <button id="readerStopSession"
                                class="hidden bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">‚è∏Ô∏è
                                –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                            <!-- –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê AI-–ê–ù–ê–õ–ò–ó -->
                            <button id="readerAiAnalyzeBtn"
                                class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed">ü§ñ
                                AI-–∞–Ω–∞–ª–∏–∑</button>
                        </div>
                        <div class="text-right">
                            <button id="readerQuizBtn"
                                class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">üß† –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
                                –∫–≤–∏–∑</button>
                        </div>
                    </div>

                    <!-- –ë–ª–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏) -->
                    <div id="readerSessionStats" class="text-xs text-gray-500 bg-gray-50 p-2 rounded flex gap-4 hidden">
                        <span>‚è≥ –í—Ä–µ–º—è: <b id="sessionTime">00:00</b></span>
                        <span>üìä –ü—Ä–æ—á–∏—Ç–∞–Ω–æ: <b id="sessionWords">0</b> —Å–ª–æ–≤</span>
                        <span>üìç –ü—Ä–æ–≥—Ä–µ—Å—Å: <b id="sessionProgress">0%</b></span>
                    </div>

                    <!-- –ò—Å—Ç–æ—Ä–∏—è —Å–µ—Å—Å–∏–π -->
                    <div id="readerHistory" class="mt-3 text-xs text-gray-400 max-h-16 overflow-y-auto"></div>
                </div>
            </div>
        </div>

        <!-- 9. CHAT VIEW -->
        <div id="view-chat" class="app-view hidden p-6 max-w-6xl mx-auto w-full h-[calc(100vh-180px)]">
            <div class="flex flex-col h-full bg-white rounded-lg shadow overflow-hidden border border-gray-200">
                <!-- Header -->
                <div class="bg-gray-900 text-white p-4 font-bold flex justify-between items-center">
                    <div class="flex items-center gap-2">
                        <span>üí¨ MiMo Chat</span>
                        <span class="text-xs font-normal bg-gray-700 px-2 py-0.5 rounded"
                            id="chatModelName">mimo-v2-flash</span>
                    </div>
                    <div class="flex gap-2">
                        <button id="chatClearBtn"
                            class="text-xs bg-gray-700 px-3 py-1 rounded hover:bg-gray-600 transition">üóëÔ∏è
                            –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                </div>

                <!-- Messages Container (—Å–∫—Ä–æ–ª–ª) -->
                <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50">
                    <!-- –ó–¥–µ—Å—å –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è -->
                    <!-- –ó–∞–≥–ª—É—à–∫–∞ –ø—Ä–∏ –ø—É—Å—Ç–æ–º —á–∞—Ç–µ -->
                    <div class="flex h-full items-center justify-center text-gray-400 flex-col gap-2">
                        <span class="text-2xl">ü§ñ</span>
                        <span>–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å...</span>
                    </div>
                </div>

                <!-- Typing Indicator -->
                <div id="chatTypingStatus"
                    class="hidden px-4 py-2 text-xs text-gray-500 bg-gray-100 border-t animate-pulse">
                    –ë–æ—Ç –ø–µ—á–∞—Ç–∞–µ—Ç...
                </div>

                <!-- Input Area -->
                <div class="p-4 border-t bg-white flex gap-2 items-end">
                    <textarea id="chatInput"
                        class="flex-1 border border-gray-300 rounded-lg p-3 resize-none focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ... (Enter - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å, Shift+Enter - –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞)"
                        rows="2"></textarea>
                    <button id="chatSendBtn"
                        class="bg-indigo-600 text-white px-5 py-3 rounded-lg font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition whitespace-nowrap">
                        –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>

        <!-- 10. SETTINGS VIEW -->
        <div id="view-settings" class="app-view hidden p-6 max-w-3xl mx-auto">
            <div class="bg-white p-6 rounded-xl shadow-sm">
                <h2 class="text-2xl font-bold mb-6 text-gray-800 border-b pb-2">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>

                <!-- –ì—Ä—É–ø–ø–∞: –°–Ω–æ—Å–∫–∏ (Explanation) -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-blue-600 mb-4">üß† –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –°–Ω–æ—Å–æ–∫ (MiMo)</h3>

                    <div class="space-y-4">
                        <!-- –ú–∞–∫—Å. —Ç–æ–∫–µ–Ω–æ–≤ -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞
                                <span id="labelMaxTokens" class="text-xs text-gray-500">(–¢–µ–∫—É—â–µ–µ: 500)</span>
                            </label>
                            <input type="range" id="settingMaxTokens" min="50" max="2000" step="50"
                                class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <div class="text-xs text-gray-400 flex justify-between"><span>–ö—Ä–∞—Ç–∫–æ (50)</span><span>–ú–Ω–æ–≥–æ
                                    (2000)</span></div>
                        </div>

                        <!-- Temperature -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                –¢–æ—á–Ω–æ—Å—Ç—å / –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
                                <span id="labelTemp" class="text-xs text-gray-500">(–¢–µ–∫—É—â–µ–µ: 0.2)</span>
                            </label>
                            <input type="range" id="settingTemperature" min="0" max="1" step="0.1"
                                class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <div class="text-xs text-gray-400 flex justify-between"><span>–¢–æ—á–Ω–æ
                                    (0.0)</span><span>–°–≤–æ–±–æ–¥–Ω–æ (1.0)</span></div>
                        </div>

                        <!-- –ê–≤—Ç–æ-–∑–∞–ø—Ä–æ—Å -->
                        <div class="flex items-center">
                            <input type="checkbox" id="settingAutoRequest"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                            <label for="settingAutoRequest" class="ml-2 text-sm font-medium text-gray-700">–ó–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å
                                —Å–Ω–æ—Å–∫—É —Å—Ä–∞–∑—É –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏</label>
                        </div>

                        <!-- –ü—Ä–æ–º–ø—Ç -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
                                AI)</label>
                            <textarea id="settingSystemPrompt" rows="3"
                                class="w-full p-2 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"></textarea>
                            <p class="text-xs text-gray-400 mt-1">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–æ–π AI –±—É–¥–µ—Ç —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ.</p>
                        </div>
                    </div>
                </div>

                <!-- –í—Å—Ç–∞–≤—å —ç—Ç–æ –ø–æ—Å–ª–µ –±–ª–æ–∫–∞ "–ü—Ä–æ–º–ø—Ç" –∏ –ø–µ—Ä–µ–¥ "–ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è" –≤ view-settings -->
                <div class="mt-6 pt-4 border-t">
                    <h3 class="text-md font-semibold text-gray-700 mb-3">‚öôÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –ü—Ä–µ—Å–µ—Ç–æ–≤</h3>
                    <div class="space-y-3" id="presetsContainer">
                        <!-- –°—é–¥–∞ JS –¥–æ–±–∞–≤–∏—Ç –ø–æ–ª—è -->
                    </div>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
                <div class="mt-6 pt-4 border-t">
                    <button id="saveSettingsBtn"
                        class="px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium shadow-sm">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                        –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    <span id="saveStatus" class="ml-3 text-sm text-green-600 hidden">‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ</span>
                </div>
            </div>
        </div>

        <!-- Backup Section -->
        <div class="mt-8 p-4 border border-gray-300 rounded bg-gray-50 max-w-2xl mx-auto text-center">
            <h4 class="font-bold mb-2 text-gray-700">–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</h4>
            <p class="text-xs text-gray-500 mb-2">–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ.</p>
            <div class="flex gap-2 justify-center">
                <button id="btnExport"
                    class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 text-sm">–°–∫–∞—á–∞—Ç—å JSON</button>
                <label class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm cursor-pointer">
                    –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON
                    <input type="file" id="fileImport" accept=".json" class="hidden">
                </label>
            </div>
        </div>
    </main>

    <!-- Modal Container -->
    <div id="modalContainer"></div>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="state.js"></script>
    <script src="logic.js"></script>
    <script src="ui.js"></script>
    <script src="main.js"></script>
</body>

</html>